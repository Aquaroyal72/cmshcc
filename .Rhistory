diag <- generateTestDIAG(cmshcc_map = cmshcc_map)
library(icd9)
results <- icd9RiskAdjCMSHCC14(DIAG = diag, PERSON = person, cmshcc_list = cmshcc_list)
head(results)
enrolleeResults <- age_gender_only(PERSON = person)
head(enrolleeResults)
head(person)
library(cmshcc)
person <- generateTestPERSON()
head(person)
tail(person)
library(cmshcc)
female_factors <- c(.545, .723, .881, .957, 1.094, .504, .506, .506, .543, .569, .660, .864, 1.057, 1.264, 1.264, 1.264)
female_medicaid_factors <- c(.919, 1.097, 1.255, 1.331, 1.468, 1.085, .920, .920, .957, .983, .991, 1.165, 1.358, 1.565, 1.565, 1.565)
female_origdbld_factors <- c(1.108, 1.043, 1.043, 1.080, 1.106, 1.274, 1.478, 1.671, 1.878, 1.878, 1.878)
female_medicaid_origdbld_factors <- c(1.689, 1.457, 1.457, 1.494, 1.520, 1.605, 1.779, 1.972, 2.179, 2.179, 2.179)
male_factors <- c(.233, .510, .754, .885, .951, .517, .532, .579 .617, .657, .784, 1.046, 1.249, 1.424, 1.424, 1.424)
male_medicaid_factors <- c(.788, 1.065, 1.309, 1.440, 1.506, 1.248, 1.135, 1.182, 1.220, 1.260, 1.249, 1.445, 1.648, 1.823, 1.823, 1.823)
male_origdbld_factors <- c(.931, 1.083, 1.130, 1.168, 1.208, 1.481, 1.743, 1.946, 2.121, 2.121, 2.121)
male_medicaid_origdbld_factors <- c(1.662, 1.686, 1.733, 1.771, 1.811, 1.946, 2.142, 2.345, 2.520, 2.520, 2.520)
female_factors <- c(.545, .723, .881, .957, 1.094, .504, .506, .506, .543, .569, .660, .864, 1.057, 1.264, 1.264, 1.264)
female_medicaid_factors <- c(.919, 1.097, 1.255, 1.331, 1.468, 1.085, .920, .920, .957, .983, .991, 1.165, 1.358, 1.565, 1.565, 1.565)
female_origdbld_factors <- c(1.108, 1.043, 1.043, 1.080, 1.106, 1.274, 1.478, 1.671, 1.878, 1.878, 1.878)
female_medicaid_origdbld_factors <- c(1.689, 1.457, 1.457, 1.494, 1.520, 1.605, 1.779, 1.972, 2.179, 2.179, 2.179)
male_factors <- c(.233, .510, .754, .885, .951, .517, .532, .579, .617, .657, .784, 1.046, 1.249, 1.424, 1.424, 1.424)
male_medicaid_factors <- c(.788, 1.065, 1.309, 1.440, 1.506, 1.248, 1.135, 1.182, 1.220, 1.260, 1.249, 1.445, 1.648, 1.823, 1.823, 1.823)
male_origdbld_factors <- c(.931, 1.083, 1.130, 1.168, 1.208, 1.481, 1.743, 1.946, 2.121, 2.121, 2.121)
male_medicaid_origdbld_factors <- c(1.662, 1.686, 1.733, 1.771, 1.811, 1.946, 2.142, 2.345, 2.520, 2.520, 2.520)
factors_ne13 <- list(female_factors = female_factors, female_medicaid_factors = female_medicaid_factors, female_origdbld_factors = female_origdbld_factors, female_medicaid_origdbld_factors = female_medicaid_origdbld_factors, male_factors = male_factors, male_medicaid_factors = male_medicaid_factors, male_origdbld_factors = male_origdbld_factors, male_medicaid_origdbld_factors = male_medicaid_origdbld_factors)
factors_ne13
save(factors_ne13, file = "factors_ne13.RData")
rm(factors_ne13)
load("~/ValidateHealth/cmshcc/data/factors_ne13.RData")
factors
factors_ne13
factors <- factors_ne13
save(factors, file = "factors_ne13.RData")
rm(factors)
factors
load("~/ValidateHealth/cmshcc/data/factors_ne13.RData")
factors
fact <- factors
rm(factors)
rm(factors)
factors
names(fact$female_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_medicaid_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_medicaid_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_medicaid_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_medicaid_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
factors <- list(female_factors = female_factors, female_medicaid_factors = female_medicaid_factors, female_origdbld_factors = female_origdbld_factors, female_medicaid_origdbld_factors = female_medicaid_origdbld_factors, male_factors = male_factors, male_medicaid_factors = male_medicaid_factors, male_origdbld_factors = male_origdbld_factors, male_medicaid_origdbld_factors = male_medicaid_origdbld_factors)
factors
factors <- list(female_factors = fact$female_factors, female_medicaid_factors = fact$female_medicaid_factors, female_origdbld_factors = fact$female_origdbld_factors, female_medicaid_origdbld_factors = fact$female_medicaid_origdbld_factors, male_factors = fact$male_factors, male_medicaid_factors = fact$male_medicaid_factors, male_origdbld_factors = fact$male_origdbld_factors, male_medicaid_origdbld_factors = fact$male_medicaid_origdbld_factors)
factors
save(factors, file = "factors_ne13.RData")
female_factors <- c(1.343, 1.343, 1.504, 1.594, 1.697, .998, .998, 1.078, 1.078, 1.078, 1.267, 1.503, 1.709, 1.943, 1.943, 1.943)
female_medicaid_factors <- c(1.523, 1.523, 1.902, 2.027, 2.100, 1.626, 1.626, 1.669, 1.669, 1.669, 1.821, 2.024, 2.218, 2.476, 2.476, 2.476)
female_origdbld_factors <- c(1.793, 1.793, 1.788, 1.788, 1.788, 1.987, 2.102, 2.393, 2.393, 2.393, 2.393)
female_medicaid_origdbld_factors <- c(2.249, 2.249, 2.272, 2.272, 2.272, 2.509, 2.631, 2.804, 2.804, 2.804, 2.804)
male_factors <- c(1.389, 1.389, 1.475, 1.602, 1.641, 1.022, 1.022, 1.086, 1.086, 1.086, 1.309, 1.534, 1.796, 2.067, 2.067, 2.067)
male_medicaid_factors <- c(1.396, 1.396, 1.841, 2.037, 2.048, 1.717, 1.717, 1.774, 1.774, 1.774, 2.002, 2.094, 2.328, 2.590, 2.590, 2.590)
male_origdbld_factors <- c(1.716, 1.716, 1.774, 1.774, 1.774, 1.944, 2.064, 2.318, 2.318, 2.318, 2.318)
male_medicaid_origdbld_factors <- c(2.251, 2.251, 2.331, 2.331, 2.331, 2.486, 2.707, 2.708, 2.708, 2.708, 2.708)
fact = list(female_factors = female_factors, female_medicaid_factors = female_medicaid_factors, female_origdbld_factors = female_origdbld_factors, female_medicaid_origdbld_factors = female_medicaid_origdbld_factors, male_factors = male_factors, male_medicaid_factors = male_medicaid_factors, male_origdbld_factors = male_origdbld_factors, male_medicaid_origdbld_factors = male_medicaid_origdbld_factors)
names(fact$female_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_medicaid_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_medicaid_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_medicaid_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_medicaid_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
factors <- list(female_factors = fact$female_factors, female_medicaid_factors = fact$female_medicaid_factors, female_origdbld_factors = fact$female_origdbld_factors, female_medicaid_origdbld_factors = fact$female_medicaid_origdbld_factors, male_factors = fact$male_factors, male_medicaid_factors = fact$male_medicaid_factors, male_origdbld_factors = fact$male_origdbld_factors, male_medicaid_origdbld_factors = fact$male_medicaid_origdbld_factors)
factors
save(factors, file = "factors_ne14.RData")
person <- generateTestPERSON()
head(person)
library(cmshcc)
load("~/ValidateHealth/cmshcc/data/factors_ne13.RData")
icd9RiskAdjCMSHCCne13(PERSON = person)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
factors["female_factors"]
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
PERSON$AGE <- as.numeric(round(difftime(date, as.Date(PERSON$DOB, "%Y-%m-%d", tz = "UTC"), units = "weeks")/52.25))
PERSON$ORIGDS <- (PERSON$AGE >= 65) & (PERSON$OREC %in% c(1,3))
breaks <- c(0, 35, 45, 55, 60, 65, 66, 67, 68, 69, 70, 75, 80, 85, 90, 95, 120)
PERSON$AGE_BAND <- cut(x = PERSON$AGE, breaks = breaks, include.lowest = TRUE, right = FALSE)
class(PERSON$AGE_BAND)
PERSON$FEMALE <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 0))
PERSON$FEMALE_MCAID <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 0))
PERSON$FEMALE_ORIGDS <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 1))
PERSON$FEMALE_MCAID_ORIGDS <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 1))
PERSON$MALE <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 0))
PERSON$MALE_MCAID <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 0))
PERSON$MALE_ORIGDS <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 1))
PERSON$MALE_MCAID_ORIGDS <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 1))
PERSON$STRING_AGEBAND <- as.chracter(PERSON$AGE_BAND)
PERSON <- person
PERSON$AGE <- as.numeric(round(difftime(date, as.Date(PERSON$DOB, "%Y-%m-%d", tz = "UTC"), units = "weeks")/52.25))
PERSON$ORIGDS <- (PERSON$AGE >= 65) & (PERSON$OREC %in% c(1,3))
breaks <- c(0, 35, 45, 55, 60, 65, 66, 67, 68, 69, 70, 75, 80, 85, 90, 95, 120)
PERSON$AGE_BAND <- cut(x = PERSON$AGE, breaks = breaks, include.lowest = TRUE, right = FALSE)
class(PERSON$AGE_BAND)
PERSON$FEMALE <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 0))
PERSON$FEMALE_MCAID <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 0))
PERSON$FEMALE_ORIGDS <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 1))
PERSON$FEMALE_MCAID_ORIGDS <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 1))
PERSON$MALE <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 0))
PERSON$MALE_MCAID <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 0))
PERSON$MALE_ORIGDS <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 1))
PERSON$MALE_MCAID_ORIGDS <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 1))
PERSON$STRING_AGEBAND <- as.chracter(PERSON$AGE_BAND)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
factors
library(cmshcc)
head(person)
factors
icd9RiskAdjCMSHCCne13(PERSON = person)
icd9RiskAdjCMSHCCne13(PERSON = person, factor_list = factors)
PERSON <- person
PERSON$TOTAL <- PERSON$FEMALE * factor_list$female_factors[PERSON$AGE_BAND]
factor_list <- factors
PERSON$TOTAL <- PERSON$FEMALE * factor_list$female_factors[PERSON$AGE_BAND]
PERSON$TOTAL <- (PERSON$FEMALE == 1) * factor_list$female_factors[PERSON$AGE_BAND]
labels(factor_list)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
person2 <- PERSON[1:6,]
icd9RiskAdjCMSHCCne13(PERSON = person2)
factors$female_factors <- c(1.343, 1.343, 1.504, 1.594, 1.697, .998, .998, 1.078, 1.078, 1.078, 1.267, 1.503, 1.709, 1.943, 1.943, 1.943)
factors$female_medicaid_factors <- c(1.523, 1.523, 1.902, 2.027, 2.100, 1.626, 1.626, 1.669, 1.669, 1.669, 1.821, 2.024, 2.218, 2.476, 2.476, 2.476)
factors$female_origdbld_factors <- c(0, 0, 0, 0, 0, 1.793, 1.793, 1.788, 1.788, 1.788, 1.987, 2.102, 2.393, 2.393, 2.393, 2.393)
factors$female_medicaid_origdbld_factors <- c(0, 0, 0, 0, 0, 2.249, 2.249, 2.272, 2.272, 2.272, 2.509, 2.631, 2.804, 2.804, 2.804, 2.804)
factors$male_factors <- c(1.389, 1.389, 1.475, 1.602, 1.641, 1.022, 1.022, 1.086, 1.086, 1.086, 1.309, 1.534, 1.796, 2.067, 2.067, 2.067)
factors$male_medicaid_factors <- c(1.396, 1.396, 1.841, 2.037, 2.048, 1.717, 1.717, 1.774, 1.774, 1.774, 2.002, 2.094, 2.328, 2.590, 2.590, 2.590)
factors$male_origdbld_factors <- c(0, 0, 0, 0, 0, 1.716, 1.716, 1.774, 1.774, 1.774, 1.944, 2.064, 2.318, 2.318, 2.318, 2.318)
factors$male_medicaid_origdbld_factors <- c(0, 0, 0, 0, 0, 2.251, 2.251, 2.331, 2.331, 2.331, 2.486, 2.707, 2.708, 2.708, 2.708, 2.708)
fact = list(female_factors = female_factors, female_medicaid_factors = female_medicaid_factors, female_origdbld_factors = female_origdbld_factors, female_medicaid_origdbld_factors = female_medicaid_origdbld_factors, male_factors = male_factors, male_medicaid_factors = male_medicaid_factors, male_origdbld_factors = male_origdbld_factors, male_medicaid_origdbld_factors = male_medicaid_origdbld_factors)
names(fact$female_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_medicaid_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_medicaid_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_medicaid_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_medicaid_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
factors <- list(female_factors = fact$female_factors, female_medicaid_factors = fact$female_medicaid_factors, female_origdbld_factors = fact$female_origdbld_factors, female_medicaid_origdbld_factors = fact$female_medicaid_origdbld_factors, male_factors = fact$male_factors, male_medicaid_factors = fact$male_medicaid_factors, male_origdbld_factors = fact$male_origdbld_factors, male_medicaid_origdbld_factors = fact$male_medicaid_origdbld_factors)
factors
female_factors <- c(1.343, 1.343, 1.504, 1.594, 1.697, .998, .998, 1.078, 1.078, 1.078, 1.267, 1.503, 1.709, 1.943, 1.943, 1.943)
female_medicaid_factors <- c(1.523, 1.523, 1.902, 2.027, 2.100, 1.626, 1.626, 1.669, 1.669, 1.669, 1.821, 2.024, 2.218, 2.476, 2.476, 2.476)
female_origdbld_factors <- c(0, 0, 0, 0, 0, 1.793, 1.793, 1.788, 1.788, 1.788, 1.987, 2.102, 2.393, 2.393, 2.393, 2.393)
female_medicaid_origdbld_factors <- c(0, 0, 0, 0, 0, 2.249, 2.249, 2.272, 2.272, 2.272, 2.509, 2.631, 2.804, 2.804, 2.804, 2.804)
male_factors <- c(1.389, 1.389, 1.475, 1.602, 1.641, 1.022, 1.022, 1.086, 1.086, 1.086, 1.309, 1.534, 1.796, 2.067, 2.067, 2.067)
male_medicaid_factors <- c(1.396, 1.396, 1.841, 2.037, 2.048, 1.717, 1.717, 1.774, 1.774, 1.774, 2.002, 2.094, 2.328, 2.590, 2.590, 2.590)
male_origdbld_factors <- c(0, 0, 0, 0, 0, 1.716, 1.716, 1.774, 1.774, 1.774, 1.944, 2.064, 2.318, 2.318, 2.318, 2.318)
male_medicaid_origdbld_factors <- c(0, 0, 0, 0, 0, 2.251, 2.251, 2.331, 2.331, 2.331, 2.486, 2.707, 2.708, 2.708, 2.708, 2.708)
fact = list(female_factors = female_factors, female_medicaid_factors = female_medicaid_factors, female_origdbld_factors = female_origdbld_factors, female_medicaid_origdbld_factors = female_medicaid_origdbld_factors, male_factors = male_factors, male_medicaid_factors = male_medicaid_factors, male_origdbld_factors = male_origdbld_factors, male_medicaid_origdbld_factors = male_medicaid_origdbld_factors)
names(fact$female_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_medicaid_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_medicaid_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_medicaid_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_medicaid_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
factors <- list(female_factors = fact$female_factors, female_medicaid_factors = fact$female_medicaid_factors, female_origdbld_factors = fact$female_origdbld_factors, female_medicaid_origdbld_factors = fact$female_medicaid_origdbld_factors, male_factors = fact$male_factors, male_medicaid_factors = fact$male_medicaid_factors, male_origdbld_factors = fact$male_origdbld_factors, male_medicaid_origdbld_factors = fact$male_medicaid_origdbld_factors)
factors
female_factors <- c(1.343, 1.343, 1.504, 1.594, 1.697, .998, .998, 1.078, 1.078, 1.078, 1.267, 1.503, 1.709, 1.943, 1.943, 1.943)
female_medicaid_factors <- c(1.523, 1.523, 1.902, 2.027, 2.100, 1.626, 1.626, 1.669, 1.669, 1.669, 1.821, 2.024, 2.218, 2.476, 2.476, 2.476)
female_origdbld_factors <- c(0, 0, 0, 0, 0, 1.793, 1.793, 1.788, 1.788, 1.788, 1.987, 2.102, 2.393, 2.393, 2.393, 2.393)
female_medicaid_origdbld_factors <- c(0, 0, 0, 0, 0, 2.249, 2.249, 2.272, 2.272, 2.272, 2.509, 2.631, 2.804, 2.804, 2.804, 2.804)
male_factors <- c(1.389, 1.389, 1.475, 1.602, 1.641, 1.022, 1.022, 1.086, 1.086, 1.086, 1.309, 1.534, 1.796, 2.067, 2.067, 2.067)
male_medicaid_factors <- c(1.396, 1.396, 1.841, 2.037, 2.048, 1.717, 1.717, 1.774, 1.774, 1.774, 2.002, 2.094, 2.328, 2.590, 2.590, 2.590)
male_origdbld_factors <- c(0, 0, 0, 0, 0, 1.716, 1.716, 1.774, 1.774, 1.774, 1.944, 2.064, 2.318, 2.318, 2.318, 2.318)
male_medicaid_origdbld_factors <- c(0, 0, 0, 0, 0, 2.251, 2.251, 2.331, 2.331, 2.331, 2.486, 2.707, 2.708, 2.708, 2.708, 2.708)
fact = list(female_factors = female_factors, female_medicaid_factors = female_medicaid_factors, female_origdbld_factors = female_origdbld_factors, female_medicaid_origdbld_factors = female_medicaid_origdbld_factors, male_factors = male_factors, male_medicaid_factors = male_medicaid_factors, male_origdbld_factors = male_origdbld_factors, male_medicaid_origdbld_factors = male_medicaid_origdbld_factors)
names(fact$female_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_medicaid_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_origdbld_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_medicaid_origdbld_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_medicaid_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_origdbld_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_medicaid_origdbld_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
factors <- list(female_factors = fact$female_factors, female_medicaid_factors = fact$female_medicaid_factors, female_origdbld_factors = fact$female_origdbld_factors, female_medicaid_origdbld_factors = fact$female_medicaid_origdbld_factors, male_factors = fact$male_factors, male_medicaid_factors = fact$male_medicaid_factors, male_origdbld_factors = fact$male_origdbld_factors, male_medicaid_origdbld_factors = fact$male_medicaid_origdbld_factors)
factors
save(factors, file = "factors_ne14.RData")
load("~/ValidateHealth/cmshcc/data/factors_ne14.RData")
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
factor_list$female_factors[1]
factor_list$female_factors[16]
factor_list$female_factors[PERSON$AGE_BAND]
test <- factor_list$female_factors[PERSON$AGE_BAND]
str(test)
test <- factor_list$female_factors[1:16]
str(test)
test <- factor_list$female_factors[c(1:16, 1:16)]
test
test <- PERSON$AGE_BAND
test
names(PERSON)
PERSON$AGE <- as.numeric(round(difftime(date, as.Date(PERSON$DOB, "%Y-%m-%d", tz = "UTC"), units = "weeks")/52.25))
PERSON$AGE <- as.numeric(round(difftime(Sys.Date(), as.Date(PERSON$DOB, "%Y-%m-%d", tz = "UTC"), units = "weeks")/52.25))
PERSON$ORIGDS <- (PERSON$AGE >= 65) & (PERSON$OREC %in% c(1,3))
breaks <- c(0, 35, 45, 55, 60, 65, 66, 67, 68, 69, 70, 75, 80, 85, 90, 95, 120)
PERSON$AGE_BAND <- cut(x = PERSON$AGE, breaks = breaks, include.lowest = TRUE, right = FALSE, labels = FALSE)
PERSON$FEMALE <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 0))
PERSON$FEMALE_MCAID <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 0))
PERSON$FEMALE_ORIGDS <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 1))
PERSON$FEMALE_MCAID_ORIGDS <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 1))
PERSON$MALE <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 0))
PERSON$MALE_MCAID <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 0))
PERSON$MALE_ORIGDS <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 1))
PERSON$MALE_MCAID_ORIGDS <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 1))
PERSON$TOTAL <- PERSON$FEMALE * factor_list$female_factors[PERSON$AGE_BAND] + PERSON$FEMALE_MCAID * factor_list$female__medicaid_factors[PERSON$AGE_BAND] + PERSON$FEMALE_ORIGDS * factor_list$female_origdbld_factors[PERSON$AGE_BAND] + PERSON$FEMALE_MCAID_ORIGDS * factor_list$female_medicaid_origdbld_factors[PERSON$AGE_BAND] + PERSON$MALE * factor_list$male_factors[PERSON$AGE_BAND] + PERSON$MALE_MCAID * factor_list$male__medicaid_factors[PERSON$AGE_BAND] + PERSON$MALE_ORIGDS * factor_list$male_origdbld_factors[PERSON$AGE_BAND] + PERSON$MALE_MCAID_ORIGDS * factor_list$male_medicaid_origdbld_fact[PERSON$AGE_BAND]
test <- PERSON$AGE_BAND
test
PERSON$FEMALE * factor_list$female_factors[PERSON$AGE_BAND]
PERSON$FEMALE_MCAID * factor_list$female__medicaid_factors[PERSON$AGE_BAND]
PERSON$FEMALE_ORIGDS * factor_list$female_origdbld_factors[PERSON$AGE_BAND]
labels(factor_list)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
PERSON$FEMALE * factor_list$female_factors[PERSON$AGE_BAND]
PERSON$FEMALE_MCAID * factor_list$female_medicaid_factors[PERSON$AGE_BAND]
PERSON$FEMALE_ORIGDS * factor_list$female_origdbld_factors[PERSON$AGE_BAND]
PERSON$FEMALE_MCAID_ORIGDS * factor_list$female_medicaid_origdbld_factors[PERSON$AGE_BAND]
factors
PERSON$MALE * factor_list$male_factors[PERSON$AGE_BAND]
PERSON$MALE_MCAID * factor_list$male__medicaid_factors[PERSON$AGE_BAND]
library(cmshcc)
PERSON$MALE_ORIGDS * factor_list$male_origdbld_factors[PERSON$AGE_BAND]
PERSON$MALE_MCAID_ORIGDS * factor_list$male_medicaid_origdbld_fact[PERSON$AGE_BAND]
icd9RiskAdjCMSHCCne13(PERSON = person)
load("~/ValidateHealth/cmshcc/data/factors_ne14.RData")
library(cmshcc)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
icd9RiskAdjCMSHCCne(PERSON = person)
library(cmshcc)
icd9RiskAdjCMSHCCne(PERSON = person)
library(cmshcc)
icd9RiskAdjCMSHCCne <- function(PERSON, date = Sys.Date(), factor_list = factors) {
PERSON$AGE <- as.numeric(round(difftime(date, as.Date(PERSON$DOB, "%Y-%m-%d", tz = "UTC"), units = "weeks")/52.25))
PERSON$ORIGDS <- (PERSON$AGE >= 65) & (PERSON$OREC %in% c(1,3))
breaks <- c(0, 35, 45, 55, 60, 65, 66, 67, 68, 69, 70, 75, 80, 85, 90, 95, 120)
PERSON$AGE_BAND <- cut(x = PERSON$AGE, breaks = breaks, include.lowest = TRUE, right = FALSE, labels = FALSE)
PERSON$FEMALE <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 0))
PERSON$FEMALE_MCAID <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 0))
PERSON$FEMALE_ORIGDS <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 1))
PERSON$FEMALE_MCAID_ORIGDS <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 1))
PERSON$MALE <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 0))
PERSON$MALE_MCAID <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 0))
PERSON$MALE_ORIGDS <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 1))
PERSON$MALE_MCAID_ORIGDS <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 1))
PERSON$TOTAL <- PERSON$FEMALE * factor_list$female_factors[PERSON$AGE_BAND] + PERSON$FEMALE_MCAID * factor_list$female_medicaid_factors[PERSON$AGE_BAND] + PERSON$FEMALE_ORIGDS * factor_list$female_origdbld_factors[PERSON$AGE_BAND] + PERSON$FEMALE_MCAID_ORIGDS * factor_list$female_medicaid_origdbld_factors[PERSON$AGE_BAND] + PERSON$MALE * factor_list$male_factors[PERSON$AGE_BAND] + PERSON$MALE_MCAID * factor_list$male_medicaid_factors[PERSON$AGE_BAND] + PERSON$MALE_ORIGDS * factor_list$male_origdbld_factors[PERSON$AGE_BAND] + PERSON$MALE_MCAID_ORIGDS * factor_list$male_medicaid_origdbld_fact[PERSON$AGE_BAND]
return(PERSON$TOTAL)
}
icd9RiskAdjCMSHCCne(PERSON = person)
factor_list <- factors
factor_list$female_medicaid_origdbld_factors[PERSON$AGE_BAND]
load("~/ValidateHealth/cmshcc/data/factors_ne13.RData")
fact <- factors
fact$female_origdbld_factors <- c(0, 0, 0, 0, 0, fact$female_origdbld_factors)
fact$female_origdbld_factors
names(fact$female_origdbld_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", names(fact$female_origdbld_factors))
names(fact$female_origdbld_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
fact$female_origdbld_factors
fact$female_origdbld_factors <- c(0, 0, 0, 0, 0, fact$female_origdbld_factors)
fact$male_origdbld_factors
fact$male_origdbld_factors <- c(0, 0, 0, 0, 0, fact$male_origdbld_factors)
names(fact$male_origdbld_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
fact$male_origdbld_factors
fact$male_medicaid_origdbld_factors <- c(0, 0, 0, 0, 0, fact$male_medicaid_origdbld_factors)
names(fact$male_medicaid_origdbld_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
fact$female_medicaid_origdbld_factors <- c(0, 0, 0, 0, 0, fact$female_medicaid_origdbld_factors)
names(fact$female_medicaid_origdbld_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
factors <- fact
save(factors, file = "factors_ne13.RData")
library(cmshcc)
test_group <- generateTestPERSON()
load("~/ValidateHealth/cmshcc/data/factors_ne14.RData")
load("~/ValidateHealth/cmshcc/data/cmshcc14_list.Rdata")
load("~/ValidateHealth/cmshcc/data/cmshcc14_list.Rdata")
df <- icd9RiskAdjCMSHCCne(PERSON = test_group)
head(df)
library(cmshcc)
load("~/ValidateHealth/cmshcc/data/factors_ne14.RData")
PERSON <- generateTestPERSON(size = 100000)
icd9RiskAdjCMSHCCne(PERSON = PERSON)
df <- icd9RiskAdjCMSHCCne(PERSON = PERSON)
PERSON$SCORE <- icd9RiskAdjCMSHCCne(PERSON = PERSON)
head(PERSON)
PERSON$AGE <- as.numeric(round(difftime(Sys.Date(), as.Date(PERSON$DOB, "%Y-%m-%d", tz = "UTC"), units = "weeks")/52.25))
PERSON$ORIGDS <- (PERSON$AGE >= 65) & (PERSON$OREC %in% c(1,3))
breaks <- c(0, 35, 45, 55, 60, 65, 66, 67, 68, 69, 70, 75, 80, 85, 90, 95, 120)
PERSON$AGE_BAND <- cut(x = PERSON$AGE, breaks = breaks, include.lowest = TRUE, right = FALSE, labels = FALSE)
PERSON$FEMALE <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 0))
PERSON$FEMALE_MCAID <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 0))
PERSON$FEMALE_ORIGDS <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 1))
PERSON$FEMALE_MCAID_ORIGDS <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 1))
PERSON$MALE <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 0))
PERSON$MALE_MCAID <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 0))
PERSON$MALE_ORIGDS <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 1))
PERSON$MALE_MCAID_ORIGDS <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 1))
PERSON$TOTAL <- PERSON$FEMALE * factor_list$female_factors[PERSON$AGE_BAND] + PERSON$FEMALE_MCAID * factor_list$female_medicaid_factors[PERSON$AGE_BAND] + PERSON$FEMALE_ORIGDS * factor_list$female_origdbld_factors[PERSON$AGE_BAND] + PERSON$FEMALE_MCAID_ORIGDS * factor_list$female_medicaid_origdbld_factors[PERSON$AGE_BAND] + PERSON$MALE * factor_list$male_factors[PERSON$AGE_BAND] + PERSON$MALE_MCAID * factor_list$male_medicaid_factors[PERSON$AGE_BAND] + PERSON$MALE_ORIGDS * factor_list$male_origdbld_factors[PERSON$AGE_BAND] + PERSON$MALE_MCAID_ORIGDS * factor_list$male_medicaid_origdbld_fact[PERSON$AGE_BAND]
return(PERSON$TOTAL)
factor_list <- factors
PERSON$AGE <- as.numeric(round(difftime(Sys.Date(), as.Date(PERSON$DOB, "%Y-%m-%d", tz = "UTC"), units = "weeks")/52.25))
PERSON$ORIGDS <- (PERSON$AGE >= 65) & (PERSON$OREC %in% c(1,3))
breaks <- c(0, 35, 45, 55, 60, 65, 66, 67, 68, 69, 70, 75, 80, 85, 90, 95, 120)
PERSON$AGE_BAND <- cut(x = PERSON$AGE, breaks = breaks, include.lowest = TRUE, right = FALSE, labels = FALSE)
PERSON$FEMALE <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 0))
PERSON$FEMALE_MCAID <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 0))
PERSON$FEMALE_ORIGDS <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 1))
PERSON$FEMALE_MCAID_ORIGDS <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 1))
PERSON$MALE <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 0))
PERSON$MALE_MCAID <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 0))
PERSON$MALE_ORIGDS <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 1))
PERSON$MALE_MCAID_ORIGDS <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 1))
PERSON$TOTAL <- PERSON$FEMALE * factor_list$female_factors[PERSON$AGE_BAND] + PERSON$FEMALE_MCAID * factor_list$female_medicaid_factors[PERSON$AGE_BAND] + PERSON$FEMALE_ORIGDS * factor_list$female_origdbld_factors[PERSON$AGE_BAND] + PERSON$FEMALE_MCAID_ORIGDS * factor_list$female_medicaid_origdbld_factors[PERSON$AGE_BAND] + PERSON$MALE * factor_list$male_factors[PERSON$AGE_BAND] + PERSON$MALE_MCAID * factor_list$male_medicaid_factors[PERSON$AGE_BAND] + PERSON$MALE_ORIGDS * factor_list$male_origdbld_factors[PERSON$AGE_BAND] + PERSON$MALE_MCAID_ORIGDS * factor_list$male_medicaid_origdbld_fact[PERSON$AGE_BAND]
return(PERSON$TOTAL)
PERSON$AGE <- as.numeric(round(difftime(Sys.Date(), as.Date(PERSON$DOB, "%Y-%m-%d", tz = "UTC"), units = "weeks")/52.25))
PERSON$ORIGDS <- (PERSON$AGE >= 65) & (PERSON$OREC %in% c(1,3))
breaks <- c(0, 35, 45, 55, 60, 65, 66, 67, 68, 69, 70, 75, 80, 85, 90, 95, 120)
PERSON$AGE_BAND <- cut(x = PERSON$AGE, breaks = breaks, include.lowest = TRUE, right = FALSE, labels = FALSE)
PERSON$FEMALE <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 0))
PERSON$FEMALE_MCAID <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 0))
PERSON$FEMALE_ORIGDS <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 1))
PERSON$FEMALE_MCAID_ORIGDS <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 1))
PERSON$MALE <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 0))
PERSON$MALE_MCAID <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 0))
PERSON$MALE_ORIGDS <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 1))
PERSON$MALE_MCAID_ORIGDS <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 1))
PERSON$TOTAL <- PERSON$FEMALE * factor_list$female_factors[PERSON$AGE_BAND] + PERSON$FEMALE_MCAID * factor_list$female_medicaid_factors[PERSON$AGE_BAND] + PERSON$FEMALE_ORIGDS * factor_list$female_origdbld_factors[PERSON$AGE_BAND] + PERSON$FEMALE_MCAID_ORIGDS * factor_list$female_medicaid_origdbld_factors[PERSON$AGE_BAND] + PERSON$MALE * factor_list$male_factors[PERSON$AGE_BAND] + PERSON$MALE_MCAID * factor_list$male_medicaid_factors[PERSON$AGE_BAND] + PERSON$MALE_ORIGDS * factor_list$male_origdbld_factors[PERSON$AGE_BAND] + PERSON$MALE_MCAID_ORIGDS * factor_list$male_medicaid_origdbld_fact[PERSON$AGE_BAND]
library(rjags)
head(PERSON)
PERSON$COST <- PERSON$TOTAL * 873.83
save(PERSON, file = "file.choose()")
save(PERSON, file = file.choose())
head(PERSON)
tail(COST)
tail(PERSON)
mydata <- PERSON$COST
vector <- c(1, 2, 3)
as.list(vector)
mean(PERSON$COST)
mean(PERSON$MCAID)
mean(PERSON$ORIGDS)
mean(PERSON$AGE_BAND)
mean(PERSON$MALE_MCAID_ORIGDS)
mean(PERSON$MALE_ORIGDS)
mean(PERSON$MALE_MCAID)
mean(PERSON$MALE)
curve(dnorm)
breaks <- seq(from = 800, to = 3000, by = 100)
hist(df$RA_benchmarks, breaks = breaks)
breaks <- seq(from = 0, to = 3000, by = 200)
hist(PERSON$COST, breaks = breaks)
curve(dnorm, 0, 2000)
breaks <- seq(from = 0, to = 3000, by = 200)
hist(PERSON$COST, breaks = breaks)
curve(dnorm(PERSON$COST, mean(PERSON$COST), sd(PERSON$COST)), 0, 2000)
curve(dnorm(x=PERSON$COST, mean(PERSON$COST), sd(PERSON$COST)), 0, 2000)
curve(dnorm(x, mean(PERSON$COST), sd(PERSON$COST)), 0, 2000)
breaks <- seq(from = 0, to = 3000, by = 200)
hist(PERSON$COST, breaks = breaks)
curve(dnorm(x, mean(PERSON$COST), sd(PERSON$COST)), 0, 2000, add=T)
curve(dnorm(x, mean(PERSON$COST), sd(PERSON$COST)), 0, 2000, add=T, col ="blue")
breaks <- seq(from = 0, to = 3000, by = 200)
hist(PERSON$COST, breaks = breaks, freq = F)
curve(dnorm(x, mean(PERSON$COST), sd(PERSON$COST)), 0, 2000, add=T, col ="blue")
install.packages("fitdistrplus")
library(fitdistrplus)
fitdist(data = PERSON$COST, distr = "weibull")
weibull_fit <- fitdist(data = PERSON$COST, distr = "weibull")
weibull_fit
fitdist(data = PERSON$COST, distr = "gamma")
curve(dgamma(x, 6.556144490, 0.007330563), 0, 2000, add=T, col ="blue")
curve(dgamma(x, 6.556144490, 0.007330563), 0, 2000, add=T, col ="green")
curve(dweibull(x, 2.577223, 1008.27271), 0, 2000, add=T, col ="red")
breaks <- seq(from = 0, to = 2500, by = 50)
hist(PERSON$COST, breaks = breaks)
curve(dgamma(x, 6.556144490, 0.007330563), 0, 2000, add=T, col ="green")
curve(dweibull(x, 2.577223, 1008.27271), 0, 2000, add=T, col ="red")
breaks <- seq(from = 0, to = 2500, by = 50)
hist(PERSON$COST, breaks = breaks, freq = F)
curve(dgamma(x, 6.556144490, 0.007330563), 0, 2000, add=T, col ="green")
curve(dweibull(x, 2.577223, 1008.27271), 0, 2000, add=T, col ="red")
curve(dnorm(x, mean(PERSON$COST), sd(PERSON$COST)), 0, 2000, add=T, col ="blue")
library(cmshcc)
test_group <- generateTestPERSON(size = 100000)
scores <- icd9RiskAdjCMSHCCne(PERSON = test_group)
PERSON$RA_benchmarks <- PERSON$TOTAL * 873.83
df <- cbind(test_group, scores, RA_benchmarks)
breaks <- seq(from = 0, to = 2500, by = 50)
hist(PERSON$COST, breaks = breaks)
load("~/person.RData")
scores <- icd9RiskAdjCMSHCCne(PERSON = test_group)
PERSON$COST <- PERSON$TOTAL * 873.83
df <- cbind(test_group, scores, PERSON$COST)
breaks <- seq(from = 0, to = 2500, by = 50)
hist(PERSON$COST, breaks = breaks)
curve(dnorm(x, mean(PERSON$COST), sd(PERSON$COST)), 0, 2000, add=T, col ="blue", lwd = 10)
curve(dgamma(x, 6.556144490, 0.007330563), 0, 2000, add=T, col ="green")
curve(dweibull(x, 2.577223, 1008.27271), 0, 2000, add=T, col ="red")
hist(PERSON$COST, breaks = breaks, freq = F)
curve(dnorm(x, mean(PERSON$COST), sd(PERSON$COST)), 0, 2000, add=T, col ="blue", lwd = 10)
curve(dgamma(x, 6.556144490, 0.007330563), 0, 2000, add=T, col ="green")
curve(dweibull(x, 2.577223, 1008.27271), 0, 2000, add=T, col ="red")
curve(dnorm(x, mean(PERSON$COST), sd(PERSON$COST)), 0, 2000, add=T, col ="blue", lwd = 4)
curve(dgamma(x, 6.556144490, 0.007330563), 0, 2000, add=T, col ="green", lwd = 4)
curve(dweibull(x, 2.577223, 1008.27271), 0, 2000, add=T, col ="red", lwd = 4)
hist(PERSON$COST, breaks = breaks, freq = F)
curve(dnorm(x, mean(PERSON$COST), sd(PERSON$COST)), 0, 2000, add=T, col ="blue", lwd = 4)
curve(dgamma(x, 6.556144490, 0.007330563), 0, 2000, add=T, col ="green", lwd = 4)
curve(dweibull(x, 2.577223, 1008.27271), 0, 2000, add=T, col ="red", lwd = 4)
library(cmshcc)
mu <- c(70, 1.5, 1.5, 1.5)
sigma <- data.frame(c(10, 0, 0, 0), c(0, .01, 0, 0), c(0, 0, .01, 0), c(0, 0, 0, .01))
test <- generateTestGROUP(mu = mu, sigma = sigma)
library(MASS)
test <- generateTestGROUP(mu = mu, sigma = sigma)
head(test)
mu <- c(70, 1.5, 0.5, 0.5)
test <- generateTestGROUP(mu = mu, sigma = sigma)
generateTestGROUP(mu = mu, sigma = sigma)
library(cmshcc)
test <- generateTestGROUP(mu = mu, sigma = sigma)
head(test)
sigma <- data.frame(c(100, 0, 0, 0), c(0, .01, 0, 0), c(0, 0, .01, 0), c(0, 0, 0, .01))
test <- generateTestGROUP(mu = mu, sigma = sigma)
head(test)
tail(test)
sigma <- data.frame(c(200, 0, 0, 0), c(0, .01, 0, 0), c(0, 0, .01, 0), c(0, 0, 0, .01))
test <- generateTestGROUP(mu = mu, sigma = sigma)
head(test)
tail(test)
breaks <- seq(0, 120, by = 10)
hist(test, breaks = breaks)
hist(test[1], breaks = breaks)
head(test[1])
hist(test[,1], breaks = breaks)
library(cmshcc)
constructSigma(age_gender = 20)
sigma <- constructSigma(age_gender = 20)
test <- generateTestGROUP(mu = mu, sigma = sigma)
head(sigma)
sigma <- constructSigma(age_gender = 1)
test <- generateTestGROUP(mu = mu, sigma = sigma)
head(test)
mean(test[,2])
test <- generateTestGROUP(mu = mu, sigma = sigma)
mean(test[,2])
mean(test[test[,1] > 70,2])
plot(x = test[,1], y = test[,2])
install.packages("SimCorMultRes")
library(SimCorMultRes)
rsmvnorm
test <- rsmvnorm(R = 4, cor.matrix = diag(4))
mean(test)
test <- rsmvnorm(R = 100, cor.matrix = diag(4))
mean(test)
head(test)
cor(test)
test <- rsmvnorm(R = 400, cor.matrix = diag(4))
cor(test)
mean(cor(test))
head(test)
install.packages("stringr")
install.packages("rpart")
install.packages("ggplot2")
install.packages("rpart.plot")
install.packages("copula")
install.packages("devtools")
require(devtools)
install.packages("icd9")
install.packages("RSQLite")
ageBand <- function(DOB, date, breaks) {
age <- as.numeric(round(difftime(date, as.Date(DOB, "%Y-%m-%d", tz = "UTC"), units = "weeks")/52.25))
age_band <- cut(x = age, breaks = breaks, include.lowest = TRUE, right = FALSE)
age_band
}
install.packages("rbenchmark")
library(cmshcc)
people <- generateTestPERSON()
head(people$DOB)
ageBand(DOB = people$DOB, date = Sys.Date(), breaks = breaks)
breaks <- c(0, 35, 45, 55, 60, 65, 66, 67, 68, 69, 70, 75, 80, 85, 90, 95, 120)
ageBand(DOB = people$DOB, date = Sys.Date(), breaks = breaks)
library(cmshcc)
