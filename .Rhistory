library(cmshcc)
library(cmshcc)
results <- icd9RiskAdjCMSHCC13(DIAG = diag, PERSON = person, cmshcc_list = cmshcc_list)
head(results)
results <- icd9RiskAdjCMSHCC(DIAG = diag, PERSON = person, cmshcc_list = cmshcc_list)
head(results)
load("~/ValidateHealth/cmshcc/data/cmshcc_list.Rdata")
head(cmshcc_list)
head(cmshcc_map)
#install private utilities from git hub
devtools::install_github(repo = "validatehealth/utilities", auth_token = "d930357bb79704e7c534aaa1424644f66b8b5942")
#library the package
library(ValidateHealthUtilities)
#use import function.  Choose the file from the CMS website unzipped package
cmshcc_map <- readVarSpace(file = file.choose())
# initialize HCC List
names(cmshcc_map) <- c("icd9", "hcc")
#Generate list of HCC mapping
hccs <- sort(unique(cmshcc_map$hcc))
cmshcc_list <- list()
for(i in 1:length(hccs)) {
label <- paste0("HCC", hccs[i])
cmshcc_list[[label]] <- subset(cmshcc_map, hcc == hccs[i])$icd9
}
head(cmshcc_map)
head(cmshcc_list)
save(cmshcc_map, file = "cmshcc13_map.RData")
getwd()
save(cmshcc_list, file = "cmshcc13_list.RData")
l1 <- c(1, 2, 3)
l2 <- c("a", "b")
factors13 <- list(female_age_factors = c(0.210, 0.217, 0.276, 0.343, 0.415, 0.279, 0.337, 0.426, 0.525, 0.651, 0.786, 0.822), male_age_factors = c(0.117, 0.133, 0.193, 0.272, 0.337, 0.283, 0.346, 0.436, 0.534, 0.656, 0.824, .993), demointeraction_factors = c(0.202, 0.103, 0.232, 0.099, 0.228, 0.160),   disease_factors = c(.458, .766, .465, 2.175, .919, .706, .187, .371, .371, .371, .371, .127, .745, 1.006, .413, .262, .310, .362, .302, .585, .361, 1.129, .945, .373, .373, .517, .360, 1.147, 1.061, .491, .464, .321, .516, .643, .278, .580, 1.767, 1.117, .531, .346, .294, .274, .170, .289, .359, .265, .534, .131, .594, .302, .385, .340, .734, .206, .236, 1.348, .297, .116, 1.165, .476, 1.246, .580, .171, .467, .435, .793, .311, 1.084, .659, .793), interaction_factors = c(.150, .150, .278, .233, .262, .600), disabl_int_factors = c(.597, 1.340, .383, .105, 2.556)
)
factors13
save(factors13, file = "factors_13")
save(factors13, file = "factors_13.RData")
factors14 <- list(female_age_factors = c(0.201, 0.211, 0.270, 0.334, 0.402, 0.295, 0.357, 0.448, 0.553, 0.694, 0.835, 0.861), male_age_factors = c(0.124, 0.127, 0.186, 0.275, 0.319, 0.295, 0.365, 0.454, 0.557, 0.700, 0.869, 1.054), demointeraction_factors = c(0.155, 0.087, 0.181, 0.088, 0.245, 0.167), disease_factors = c(.482, .548, .451, 2.546, 0.997, 0.689, 0.325, 0.158, 0.378, 0.378, 0.121, 0.731, 0.374, 0.251, 0.947, 0.409, 0.257, 0.318, 0.293, 0.310, 0.510, 0.383, 1.165, 0.534, 0.258, 0.431, 0.431, 0.503, 0.339, 1.265, 1.078, 0.522, 0.982, 0.046, 0.418, 0.579, 0.570, 0.708, 0.291, 0.585, 1.558, 0.822, 0.338, 0.377, 0.282, 0.264, 0.145, 0.302, 0.347, 0.325, 0.596, 0.406, 1.449, 0.42, 0.306, 0.427, 0.355, 0.281, 0.689, 0.205, 0.208, 0.343, 0.488, 0.488, 0.230, 0.230, 2.551, 1.371, 0.549, 0.422, 0.585, 0.167, 0.509, 0.458, 0.272, 0.580, 0.913, 0.667, 0.798), interaction_factors = c(0.971, 0.265, 0.325, 0.467, 0.187, 0.219), disabl_int_factors = c(0.462, 0.562, 1.381, 0.339, 2.476, 0.516))
factors14
save(factors14, file = "factors_14.RData")
load("~/ValidateHealth/cmshcc/data/factors_13.RData")
factors_13
factors_13
load("~/ValidateHealth/cmshcc/data/cmshcc13_list.RData")
factors13
load("~/ValidateHealth/cmshcc/data/factors_14.RData")
factors14
library(cmshcc)
people <- generateTestPERSON()
load("~/ValidateHealth/cmshcc/data/cmshcc13_list.RData")
load("~/ValidateHealth/cmshcc/data/cmshcc13_map.RData")
diag <- generateTestDIAG(cmshcc_map = cmshcc_map)
head(diag)
diag <- generateTestDIAG(cmshcc_map = cmshcc_list)
diag <- generateTestDIAG(cmshcc_map = cmshcc_map)
library(cmshcc)
results <- icd9RiskAdjCMSHCC13(DIAG = diag, PERSON = person, cmshcc_list = cmshcc_list, factor_list = factors13)
results <- icd9RiskAdjCMSHCC13(DIAG = diag, PERSON = person, cmshcc_list = cmshcc_list, factor_list = factors13)
library(icd9)
results <- icd9RiskAdjCMSHCC13(DIAG = diag, PERSON = person, cmshcc_list = cmshcc_list, factor_list = factors13)
head(person)
person <- generateTestPERSON()
results <- icd9RiskAdjCMSHCC13(DIAG = diag, PERSON = person, cmshcc_list = cmshcc_list, factor_list = factors13)
head(results)
head(results)
results <- icd9RiskAdjCMSHCC13(DIAG = diag, PERSON = person, cmshcc_list = cmshcc_list, factor_list = factors13)
head(results)
factors <- factors13
save(factors, "factors_13.RData")
save(factors, file="factors_13.RData")
rm(factors)
rm(people)
load("~/ValidateHealth/cmshcc/data/factors_13.RData")
head(factors)
library(cmshcc)
load("~/ValidateHealth/cmshcc/data/factors_14.RData")
load("~/ValidateHealth/cmshcc/data/cmshcc14_map.RData")
load("~/ValidateHealth/cmshcc/data/cmshcc14_list.Rdata")
results <- icd9RiskAdjCMSHCC14(DIAG = diag, PERSON = person, cmshcc_list = cmshcc_list, factor_list = factors14)
head(results)
factors <- factors14
save(factors, "factors_14.RData")
save(factors, file="factors_14.RData")
results <- icd9RiskAdjCMSHCC14(DIAG = diag, PERSON = person)
library(cmshcc)
results <- icd9RiskAdjCMSHCC14(DIAG = diag, PERSON = person)
results <- icd9RiskAdjCMSHCC14(DIAG = diag, PERSON = person)
head(factors)
head(cmshcc_list)
results <- icd9RiskAdjCMSHCC14(DIAG = diag, PERSON = person)
results <- icd9RiskAdjCMSHCC14(DIAG = diag, PERSON = person, cmshcc_list = cmshcc_list, factor_list = factors)
head(results)
library(cmshcc)
results <- icd9RiskAdjCMSHCC14(DIAG = diag, PERSON = person)
results <- icd9RiskAdjCMSHCC14(DIAG = diag, PERSON = person, cmshcc_list = cmshcc_list)
head(results)
library(cmshcc)
library(cmshcc)
load("~/ValidateHealth/cmshcc/data/cmshcc13_list.RData")
load("~/ValidateHealth/cmshcc/data/factors_13.RData")
results <- icd9RiskAdjCMSHCC13(DIAG = diag, PERSON = person, cmshcc_list = cmshcc_list)
head(results)
library(cmshcc)
load("~/ValidateHealth/cmshcc/data/cmshcc14_list.Rdata")
load("~/ValidateHealth/cmshcc/data/factors_14.RData")
results <- icd9RiskAdjCMSHCC14(DIAG = diag, PERSON = person, cmshcc_list = cmshcc_list)
head(results)
library(cmshcc)
library(cmshcc)
library(cmshcc)
person <- generateTestPERSON()
load("~/ValidateHealth/cmshcc/data/cmshcc13_list.RData")
load("~/ValidateHealth/cmshcc/data/factors_13.RData")
load("~/ValidateHealth/cmshcc/data/cmshcc13_map.RData")
diag <- generateTestDIAG(cmshcc_map = cmshcc_map)
results <- icd9RiskAdjCMSHCC13(DIAG = diag, PERSON = person, cmshcc_list = cmshcc_list)
library(icd9)
results <- icd9RiskAdjCMSHCC13(DIAG = diag, PERSON = person, cmshcc_list = cmshcc_list)
head(results)
load("~/ValidateHealth/cmshcc/data/cmshcc14_list.Rdata")
load("~/ValidateHealth/cmshcc/data/cmshcc14_map.RData")
load("~/ValidateHealth/cmshcc/data/factors_14.RData")
diag <- generateTestDIAG(cmshcc_map = cmshcc_map)
results <- icd9RiskAdjCMSHCC14(DIAG = diag, PERSON = person, cmshcc_list = cmshcc_list)
head(results)
x <- c(1, 2, 3)
names(x) <- c("a", "b", "c")
x
load("~/ValidateHealth/cmshcc/data/factors_13.RData")
names(factors$female_age_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65-69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
factors$female_age_factors
names(factors$male_age_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65-69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
factors$male_age_factors
load("~/ValidateHealth/cmshcc/data/factors_14.RData")
factors$male_age_factors
factors <- factors$male_age_factors
load("~/ValidateHealth/cmshcc/data/factors_14.RData")
factors$male_age_factors
names(factors$male_age_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65-69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(factors$female_age_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65-69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
factorss <- c(factors$female_age_factors, factors$male_age_factors)
factorss
factorss <- cbind(factors$female_age_factors, factors$male_age_factors)
factorss
factorss <- list(female_age_factors = factors$female_age_factors, male_age_factors = factors$male_age_factors)
factorss
load("~/ValidateHealth/cmshcc/data/factors_13.RData")
factors
fact <- factors
rm(factors)
names(fact$male_age_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65-69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_age_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65-69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$demointeraction_factors) <- c("MC_F_A", "MC_F_D", "MC_M_A", "MC_M_D", "OR_F_D", "OR_M_D")
names(fact$disease_factors) <- c("HCC1", "HCC2", "HCC5", "HCC7", "HCC8", "HCC9", "HCC10", "HCC15", "HCC16", "HCC17", "HCC18", "HCC19", "HCC21", "HCC25", "HCC26", "HCC27", "HCC31", "HCC32", "HCC33", "HCC37", "HCC38", "HCC44", "HCC45", "HCC51", "HCC52", "HCC54", "HCC55", "HCC67", "HCC68", "HCC69", "HCC70", "HCC71", "HCC72", "HCC73", "HCC74", "HCC75", "HCC77", "HCC78", "HCC80", "HCC81", "HCC82", "HCC83", "HCC92", "HCC95", "HCC96", "HCC100", "HCC101", "HCC104", "HCC105", "HCC107", "HCC108", "HCC111", "HCC112", "HCC119", "HCC130", "HCC131", "HCC132", "HCC148", "HCC149", "HCC150", "HCC154", "HCC155", "HCC157", "HCC158", "HCC161", "HCC164", "HCC174", "HCC176", "HCC177")
names(fact$interaction_factors) <- c("DM_CHF", "DM_CVD", "CHF_COPD", "COPD_CVD_CAD", "RF_CHF", "RF_CHF_DM")
names(fact$disabl_int_factors) <- c("D_HCC5", "D_HCC44", "D_HCC51", "D_HCC52", "D_HCC107")
factors <- list(female_age_factors = fact$female_age_factors, male_age_factors = fact$male_age_factors, demointeraction_factors = fact$demointeraction_factors, disease_factors = fact$disease_factors, interaction_factors = fact$interaction_factors, disabl_int_factors = fact$disabl_int_factors)
factors
factors$interaction_factors
names(factors$interaction_factors)
save(factors , file = "factors_13.RData")
rm(factors)
load("~/ValidateHealth/cmshcc/data/factors_13.RData")
factors
load("~/ValidateHealth/cmshcc/data/factors_14.RData")
names(fact$disease_factors) <- c("HCC1", "HCC2", "HCC6", "HCC8", "HCC9", "HCC10", "HCC11", "HCC12", "HCC17", "HCC18", "HCC19", "HCC21", "HCC22", "HCC23", "HCC27", "HCC28", "HCC29", "HCC33", "HCC34", "HCC35", "HCC39", "HCC40", "HCC46", "HCC47", "HCC48", "HCC54", "HCC55", "HCC57", "HCC58", "HCC70", "HCC71", "HCC72", "HCC73", "HCC74", "HCC75", "HCC76", "HCC77", "HCC78", "HCC79", "HCC80", "HCC82", "HCC83", "HCC84", "HCC85", "HCC86", "HCC87", "HCC88", "HCC96", "HCC99", "HCC100", "HCC103", "HCC104", "HCC106", "HCC107", "HCC108", "HCC110", "HCC111", "HCC112", "HCC114", "HCC115", "HCC122", "HCC124", "HCC134", "HCC135", "HCC136", "HCC137", "HCC157", "HCC158", "HCC161", "HCC162", "HCC166", "HCC167", "HCC169", "HCC170", "HCC173", "HCC176", "HCC186", "HCC188", "HCC189")
names(fact$interaction_factors) <- c("CANCER_IMMUNE", "CHF_COPD", "CHF_RENAL", "COPD_CARD_RESP_FAIL", "DIABETES_CHF", "SEPSIS_CARD_RESP_FAIL", "ARTIF_OPENINGS_PRESSURE_ULCER", "ASP_SPEC_BACT_PNEUM_PRES_ULCER", "COPD_ASP_SPEC_BACT_PNEUM", "SCHIZOPHRENIA_CHF", "SCHIZOPHRENIA_COPD", "SCHIZOPHRENIA_SEIZURES", "SEPIS_ARTIF_OPENINGS", "SEPIS_ASP_SPEC_BACT_PNEUM", "SEPIS_PRESSURE_ULCER")
names(fact$disabl_int_factors) <- c("D_HCC6", "D_HCC34", "D_HCC39", "D_HCC46", "D_HCC54", "D_HCC55", "D_HCC77", "D_HCC85", "D_HCC110", "D_HCC161", "D_HCC176", "D_PRESSURE_ULCER")
names(fact$interaction_factors) <- c("CANCER_IMMUNE", "CHF_COPD", "CHF_RENAL", "COPD_CARD_RESP_FAIL", "DIABETES_CHF", "SEPSIS_CARD_RESP_FAIL")
names(fact$disabl_int_factors) <- c("D_HCC6", "D_HCC34", "D_HCC46", "D_HCC54", "D_HCC110", "D_HCC176")
names(fact$male_age_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65-69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_age_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65-69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$demointeraction_factors) <- c("MC_F_A", "MC_F_D", "MC_M_A", "MC_M_D", "OR_F_D", "OR_M_D")
factors
fact$disabl_int_factors
load("~/ValidateHealth/cmshcc/data/factors_14.RData")
factors$disabl_int_factors
fact <- factors
rm(factors)
names(fact$male_age_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65-69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_age_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65-69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$demointeraction_factors) <- c("MC_F_A", "MC_F_D", "MC_M_A", "MC_M_D", "OR_F_D", "OR_M_D")
names(fact$disease_factors) <- c("HCC1", "HCC2", "HCC6", "HCC8", "HCC9", "HCC10", "HCC11", "HCC12", "HCC17", "HCC18", "HCC19", "HCC21", "HCC22", "HCC23", "HCC27", "HCC28", "HCC29", "HCC33", "HCC34", "HCC35", "HCC39", "HCC40", "HCC46", "HCC47", "HCC48", "HCC54", "HCC55", "HCC57", "HCC58", "HCC70", "HCC71", "HCC72", "HCC73", "HCC74", "HCC75", "HCC76", "HCC77", "HCC78", "HCC79", "HCC80", "HCC82", "HCC83", "HCC84", "HCC85", "HCC86", "HCC87", "HCC88", "HCC96", "HCC99", "HCC100", "HCC103", "HCC104", "HCC106", "HCC107", "HCC108", "HCC110", "HCC111", "HCC112", "HCC114", "HCC115", "HCC122", "HCC124", "HCC134", "HCC135", "HCC136", "HCC137", "HCC157", "HCC158", "HCC161", "HCC162", "HCC166", "HCC167", "HCC169", "HCC170", "HCC173", "HCC176", "HCC186", "HCC188", "HCC189")
names(fact$interaction_factors) <- c("CANCER_IMMUNE", "CHF_COPD", "CHF_RENAL", "COPD_CARD_RESP_FAIL", "DIABETES_CHF", "SEPSIS_CARD_RESP_FAIL")
names(fact$disabl_int_factors) <- c("D_HCC6", "D_HCC34", "D_HCC46", "D_HCC54", "D_HCC110", "D_HCC176")
factors <- list(female_age_factors = fact$female_age_factors, male_age_factors = fact$male_age_factors, demointeraction_factors = fact$demointeraction_factors, disease_factors = fact$disease_factors, interaction_factors = fact$interaction_factors, disabl_int_factors = fact$disabl_int_factors)
factors
save(factors , file = "factors_14.RData")
load("~/ValidateHealth/cmshcc/data/factors_14.RData")
factors
library(cmshcc)
library(cmshcc)
library(cmshcc)
load("~/ValidateHealth/cmshcc/data/factors_14.RData")
load("~/ValidateHealth/cmshcc/data/cmshcc14_map.RData")
load("~/ValidateHealth/cmshcc/data/cmshcc14_list.Rdata")
person <- generateTestPERSON()
head(person)
age_gender_results <- age_gender_only(PERSON = person)
head(age_gender_results)
head(factors)
factors$female_age_factors
factors$male_age_factors
person <- generateTestPERSON(seed = 1)
age_gender_results <- age_gender_only(PERSON = person)
head(age_gender_results)
head(person)
library(cmshcc)
library(cmshcc)
load("~/ValidateHealth/cmshcc/data/factors_14.RData")
load("~/ValidateHealth/cmshcc/data/cmshcc14_map.RData")
load("~/ValidateHealth/cmshcc/data/cmshcc14_list.Rdata")
person <- generateTestPERSON()
diag <- generateTestDIAG(cmshcc_map = cmshcc_map)
library(icd9)
results <- icd9RiskAdjCMSHCC14(DIAG = diag, PERSON = person, cmshcc_list = cmshcc_list)
head(results)
enrolleeResults <- age_gender_only(PERSON = person)
head(enrolleeResults)
head(person)
library(cmshcc)
person <- generateTestPERSON()
head(person)
tail(person)
library(cmshcc)
female_factors <- c(.545, .723, .881, .957, 1.094, .504, .506, .506, .543, .569, .660, .864, 1.057, 1.264, 1.264, 1.264)
female_medicaid_factors <- c(.919, 1.097, 1.255, 1.331, 1.468, 1.085, .920, .920, .957, .983, .991, 1.165, 1.358, 1.565, 1.565, 1.565)
female_origdbld_factors <- c(1.108, 1.043, 1.043, 1.080, 1.106, 1.274, 1.478, 1.671, 1.878, 1.878, 1.878)
female_medicaid_origdbld_factors <- c(1.689, 1.457, 1.457, 1.494, 1.520, 1.605, 1.779, 1.972, 2.179, 2.179, 2.179)
male_factors <- c(.233, .510, .754, .885, .951, .517, .532, .579 .617, .657, .784, 1.046, 1.249, 1.424, 1.424, 1.424)
male_medicaid_factors <- c(.788, 1.065, 1.309, 1.440, 1.506, 1.248, 1.135, 1.182, 1.220, 1.260, 1.249, 1.445, 1.648, 1.823, 1.823, 1.823)
male_origdbld_factors <- c(.931, 1.083, 1.130, 1.168, 1.208, 1.481, 1.743, 1.946, 2.121, 2.121, 2.121)
male_medicaid_origdbld_factors <- c(1.662, 1.686, 1.733, 1.771, 1.811, 1.946, 2.142, 2.345, 2.520, 2.520, 2.520)
female_factors <- c(.545, .723, .881, .957, 1.094, .504, .506, .506, .543, .569, .660, .864, 1.057, 1.264, 1.264, 1.264)
female_medicaid_factors <- c(.919, 1.097, 1.255, 1.331, 1.468, 1.085, .920, .920, .957, .983, .991, 1.165, 1.358, 1.565, 1.565, 1.565)
female_origdbld_factors <- c(1.108, 1.043, 1.043, 1.080, 1.106, 1.274, 1.478, 1.671, 1.878, 1.878, 1.878)
female_medicaid_origdbld_factors <- c(1.689, 1.457, 1.457, 1.494, 1.520, 1.605, 1.779, 1.972, 2.179, 2.179, 2.179)
male_factors <- c(.233, .510, .754, .885, .951, .517, .532, .579, .617, .657, .784, 1.046, 1.249, 1.424, 1.424, 1.424)
male_medicaid_factors <- c(.788, 1.065, 1.309, 1.440, 1.506, 1.248, 1.135, 1.182, 1.220, 1.260, 1.249, 1.445, 1.648, 1.823, 1.823, 1.823)
male_origdbld_factors <- c(.931, 1.083, 1.130, 1.168, 1.208, 1.481, 1.743, 1.946, 2.121, 2.121, 2.121)
male_medicaid_origdbld_factors <- c(1.662, 1.686, 1.733, 1.771, 1.811, 1.946, 2.142, 2.345, 2.520, 2.520, 2.520)
factors_ne13 <- list(female_factors = female_factors, female_medicaid_factors = female_medicaid_factors, female_origdbld_factors = female_origdbld_factors, female_medicaid_origdbld_factors = female_medicaid_origdbld_factors, male_factors = male_factors, male_medicaid_factors = male_medicaid_factors, male_origdbld_factors = male_origdbld_factors, male_medicaid_origdbld_factors = male_medicaid_origdbld_factors)
factors_ne13
save(factors_ne13, file = "factors_ne13.RData")
rm(factors_ne13)
load("~/ValidateHealth/cmshcc/data/factors_ne13.RData")
factors
factors_ne13
factors <- factors_ne13
save(factors, file = "factors_ne13.RData")
rm(factors)
factors
load("~/ValidateHealth/cmshcc/data/factors_ne13.RData")
factors
fact <- factors
rm(factors)
rm(factors)
factors
names(fact$female_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_medicaid_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_medicaid_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_medicaid_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_medicaid_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
factors <- list(female_factors = female_factors, female_medicaid_factors = female_medicaid_factors, female_origdbld_factors = female_origdbld_factors, female_medicaid_origdbld_factors = female_medicaid_origdbld_factors, male_factors = male_factors, male_medicaid_factors = male_medicaid_factors, male_origdbld_factors = male_origdbld_factors, male_medicaid_origdbld_factors = male_medicaid_origdbld_factors)
factors
factors <- list(female_factors = fact$female_factors, female_medicaid_factors = fact$female_medicaid_factors, female_origdbld_factors = fact$female_origdbld_factors, female_medicaid_origdbld_factors = fact$female_medicaid_origdbld_factors, male_factors = fact$male_factors, male_medicaid_factors = fact$male_medicaid_factors, male_origdbld_factors = fact$male_origdbld_factors, male_medicaid_origdbld_factors = fact$male_medicaid_origdbld_factors)
factors
save(factors, file = "factors_ne13.RData")
female_factors <- c(1.343, 1.343, 1.504, 1.594, 1.697, .998, .998, 1.078, 1.078, 1.078, 1.267, 1.503, 1.709, 1.943, 1.943, 1.943)
female_medicaid_factors <- c(1.523, 1.523, 1.902, 2.027, 2.100, 1.626, 1.626, 1.669, 1.669, 1.669, 1.821, 2.024, 2.218, 2.476, 2.476, 2.476)
female_origdbld_factors <- c(1.793, 1.793, 1.788, 1.788, 1.788, 1.987, 2.102, 2.393, 2.393, 2.393, 2.393)
female_medicaid_origdbld_factors <- c(2.249, 2.249, 2.272, 2.272, 2.272, 2.509, 2.631, 2.804, 2.804, 2.804, 2.804)
male_factors <- c(1.389, 1.389, 1.475, 1.602, 1.641, 1.022, 1.022, 1.086, 1.086, 1.086, 1.309, 1.534, 1.796, 2.067, 2.067, 2.067)
male_medicaid_factors <- c(1.396, 1.396, 1.841, 2.037, 2.048, 1.717, 1.717, 1.774, 1.774, 1.774, 2.002, 2.094, 2.328, 2.590, 2.590, 2.590)
male_origdbld_factors <- c(1.716, 1.716, 1.774, 1.774, 1.774, 1.944, 2.064, 2.318, 2.318, 2.318, 2.318)
male_medicaid_origdbld_factors <- c(2.251, 2.251, 2.331, 2.331, 2.331, 2.486, 2.707, 2.708, 2.708, 2.708, 2.708)
fact = list(female_factors = female_factors, female_medicaid_factors = female_medicaid_factors, female_origdbld_factors = female_origdbld_factors, female_medicaid_origdbld_factors = female_medicaid_origdbld_factors, male_factors = male_factors, male_medicaid_factors = male_medicaid_factors, male_origdbld_factors = male_origdbld_factors, male_medicaid_origdbld_factors = male_medicaid_origdbld_factors)
names(fact$female_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_medicaid_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_medicaid_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_medicaid_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_medicaid_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
factors <- list(female_factors = fact$female_factors, female_medicaid_factors = fact$female_medicaid_factors, female_origdbld_factors = fact$female_origdbld_factors, female_medicaid_origdbld_factors = fact$female_medicaid_origdbld_factors, male_factors = fact$male_factors, male_medicaid_factors = fact$male_medicaid_factors, male_origdbld_factors = fact$male_origdbld_factors, male_medicaid_origdbld_factors = fact$male_medicaid_origdbld_factors)
factors
save(factors, file = "factors_ne14.RData")
person <- generateTestPERSON()
head(person)
library(cmshcc)
load("~/ValidateHealth/cmshcc/data/factors_ne13.RData")
icd9RiskAdjCMSHCCne13(PERSON = person)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
factors["female_factors"]
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
PERSON$AGE <- as.numeric(round(difftime(date, as.Date(PERSON$DOB, "%Y-%m-%d", tz = "UTC"), units = "weeks")/52.25))
PERSON$ORIGDS <- (PERSON$AGE >= 65) & (PERSON$OREC %in% c(1,3))
breaks <- c(0, 35, 45, 55, 60, 65, 66, 67, 68, 69, 70, 75, 80, 85, 90, 95, 120)
PERSON$AGE_BAND <- cut(x = PERSON$AGE, breaks = breaks, include.lowest = TRUE, right = FALSE)
class(PERSON$AGE_BAND)
PERSON$FEMALE <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 0))
PERSON$FEMALE_MCAID <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 0))
PERSON$FEMALE_ORIGDS <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 1))
PERSON$FEMALE_MCAID_ORIGDS <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 1))
PERSON$MALE <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 0))
PERSON$MALE_MCAID <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 0))
PERSON$MALE_ORIGDS <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 1))
PERSON$MALE_MCAID_ORIGDS <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 1))
PERSON$STRING_AGEBAND <- as.chracter(PERSON$AGE_BAND)
PERSON <- person
PERSON$AGE <- as.numeric(round(difftime(date, as.Date(PERSON$DOB, "%Y-%m-%d", tz = "UTC"), units = "weeks")/52.25))
PERSON$ORIGDS <- (PERSON$AGE >= 65) & (PERSON$OREC %in% c(1,3))
breaks <- c(0, 35, 45, 55, 60, 65, 66, 67, 68, 69, 70, 75, 80, 85, 90, 95, 120)
PERSON$AGE_BAND <- cut(x = PERSON$AGE, breaks = breaks, include.lowest = TRUE, right = FALSE)
class(PERSON$AGE_BAND)
PERSON$FEMALE <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 0))
PERSON$FEMALE_MCAID <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 0))
PERSON$FEMALE_ORIGDS <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 1))
PERSON$FEMALE_MCAID_ORIGDS <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 1))
PERSON$MALE <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 0))
PERSON$MALE_MCAID <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 0))
PERSON$MALE_ORIGDS <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 1))
PERSON$MALE_MCAID_ORIGDS <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 1))
PERSON$STRING_AGEBAND <- as.chracter(PERSON$AGE_BAND)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
factors
library(cmshcc)
head(person)
factors
icd9RiskAdjCMSHCCne13(PERSON = person)
icd9RiskAdjCMSHCCne13(PERSON = person, factor_list = factors)
PERSON <- person
PERSON$TOTAL <- PERSON$FEMALE * factor_list$female_factors[PERSON$AGE_BAND]
factor_list <- factors
PERSON$TOTAL <- PERSON$FEMALE * factor_list$female_factors[PERSON$AGE_BAND]
PERSON$TOTAL <- (PERSON$FEMALE == 1) * factor_list$female_factors[PERSON$AGE_BAND]
labels(factor_list)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
person2 <- PERSON[1:6,]
icd9RiskAdjCMSHCCne13(PERSON = person2)
factors$female_factors <- c(1.343, 1.343, 1.504, 1.594, 1.697, .998, .998, 1.078, 1.078, 1.078, 1.267, 1.503, 1.709, 1.943, 1.943, 1.943)
factors$female_medicaid_factors <- c(1.523, 1.523, 1.902, 2.027, 2.100, 1.626, 1.626, 1.669, 1.669, 1.669, 1.821, 2.024, 2.218, 2.476, 2.476, 2.476)
factors$female_origdbld_factors <- c(0, 0, 0, 0, 0, 1.793, 1.793, 1.788, 1.788, 1.788, 1.987, 2.102, 2.393, 2.393, 2.393, 2.393)
factors$female_medicaid_origdbld_factors <- c(0, 0, 0, 0, 0, 2.249, 2.249, 2.272, 2.272, 2.272, 2.509, 2.631, 2.804, 2.804, 2.804, 2.804)
factors$male_factors <- c(1.389, 1.389, 1.475, 1.602, 1.641, 1.022, 1.022, 1.086, 1.086, 1.086, 1.309, 1.534, 1.796, 2.067, 2.067, 2.067)
factors$male_medicaid_factors <- c(1.396, 1.396, 1.841, 2.037, 2.048, 1.717, 1.717, 1.774, 1.774, 1.774, 2.002, 2.094, 2.328, 2.590, 2.590, 2.590)
factors$male_origdbld_factors <- c(0, 0, 0, 0, 0, 1.716, 1.716, 1.774, 1.774, 1.774, 1.944, 2.064, 2.318, 2.318, 2.318, 2.318)
factors$male_medicaid_origdbld_factors <- c(0, 0, 0, 0, 0, 2.251, 2.251, 2.331, 2.331, 2.331, 2.486, 2.707, 2.708, 2.708, 2.708, 2.708)
fact = list(female_factors = female_factors, female_medicaid_factors = female_medicaid_factors, female_origdbld_factors = female_origdbld_factors, female_medicaid_origdbld_factors = female_medicaid_origdbld_factors, male_factors = male_factors, male_medicaid_factors = male_medicaid_factors, male_origdbld_factors = male_origdbld_factors, male_medicaid_origdbld_factors = male_medicaid_origdbld_factors)
names(fact$female_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_medicaid_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_medicaid_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_medicaid_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_medicaid_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
factors <- list(female_factors = fact$female_factors, female_medicaid_factors = fact$female_medicaid_factors, female_origdbld_factors = fact$female_origdbld_factors, female_medicaid_origdbld_factors = fact$female_medicaid_origdbld_factors, male_factors = fact$male_factors, male_medicaid_factors = fact$male_medicaid_factors, male_origdbld_factors = fact$male_origdbld_factors, male_medicaid_origdbld_factors = fact$male_medicaid_origdbld_factors)
factors
female_factors <- c(1.343, 1.343, 1.504, 1.594, 1.697, .998, .998, 1.078, 1.078, 1.078, 1.267, 1.503, 1.709, 1.943, 1.943, 1.943)
female_medicaid_factors <- c(1.523, 1.523, 1.902, 2.027, 2.100, 1.626, 1.626, 1.669, 1.669, 1.669, 1.821, 2.024, 2.218, 2.476, 2.476, 2.476)
female_origdbld_factors <- c(0, 0, 0, 0, 0, 1.793, 1.793, 1.788, 1.788, 1.788, 1.987, 2.102, 2.393, 2.393, 2.393, 2.393)
female_medicaid_origdbld_factors <- c(0, 0, 0, 0, 0, 2.249, 2.249, 2.272, 2.272, 2.272, 2.509, 2.631, 2.804, 2.804, 2.804, 2.804)
male_factors <- c(1.389, 1.389, 1.475, 1.602, 1.641, 1.022, 1.022, 1.086, 1.086, 1.086, 1.309, 1.534, 1.796, 2.067, 2.067, 2.067)
male_medicaid_factors <- c(1.396, 1.396, 1.841, 2.037, 2.048, 1.717, 1.717, 1.774, 1.774, 1.774, 2.002, 2.094, 2.328, 2.590, 2.590, 2.590)
male_origdbld_factors <- c(0, 0, 0, 0, 0, 1.716, 1.716, 1.774, 1.774, 1.774, 1.944, 2.064, 2.318, 2.318, 2.318, 2.318)
male_medicaid_origdbld_factors <- c(0, 0, 0, 0, 0, 2.251, 2.251, 2.331, 2.331, 2.331, 2.486, 2.707, 2.708, 2.708, 2.708, 2.708)
fact = list(female_factors = female_factors, female_medicaid_factors = female_medicaid_factors, female_origdbld_factors = female_origdbld_factors, female_medicaid_origdbld_factors = female_medicaid_origdbld_factors, male_factors = male_factors, male_medicaid_factors = male_medicaid_factors, male_origdbld_factors = male_origdbld_factors, male_medicaid_origdbld_factors = male_medicaid_origdbld_factors)
names(fact$female_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_medicaid_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_medicaid_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_medicaid_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_medicaid_origdbld_factors) <- c("65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
factors <- list(female_factors = fact$female_factors, female_medicaid_factors = fact$female_medicaid_factors, female_origdbld_factors = fact$female_origdbld_factors, female_medicaid_origdbld_factors = fact$female_medicaid_origdbld_factors, male_factors = fact$male_factors, male_medicaid_factors = fact$male_medicaid_factors, male_origdbld_factors = fact$male_origdbld_factors, male_medicaid_origdbld_factors = fact$male_medicaid_origdbld_factors)
factors
female_factors <- c(1.343, 1.343, 1.504, 1.594, 1.697, .998, .998, 1.078, 1.078, 1.078, 1.267, 1.503, 1.709, 1.943, 1.943, 1.943)
female_medicaid_factors <- c(1.523, 1.523, 1.902, 2.027, 2.100, 1.626, 1.626, 1.669, 1.669, 1.669, 1.821, 2.024, 2.218, 2.476, 2.476, 2.476)
female_origdbld_factors <- c(0, 0, 0, 0, 0, 1.793, 1.793, 1.788, 1.788, 1.788, 1.987, 2.102, 2.393, 2.393, 2.393, 2.393)
female_medicaid_origdbld_factors <- c(0, 0, 0, 0, 0, 2.249, 2.249, 2.272, 2.272, 2.272, 2.509, 2.631, 2.804, 2.804, 2.804, 2.804)
male_factors <- c(1.389, 1.389, 1.475, 1.602, 1.641, 1.022, 1.022, 1.086, 1.086, 1.086, 1.309, 1.534, 1.796, 2.067, 2.067, 2.067)
male_medicaid_factors <- c(1.396, 1.396, 1.841, 2.037, 2.048, 1.717, 1.717, 1.774, 1.774, 1.774, 2.002, 2.094, 2.328, 2.590, 2.590, 2.590)
male_origdbld_factors <- c(0, 0, 0, 0, 0, 1.716, 1.716, 1.774, 1.774, 1.774, 1.944, 2.064, 2.318, 2.318, 2.318, 2.318)
male_medicaid_origdbld_factors <- c(0, 0, 0, 0, 0, 2.251, 2.251, 2.331, 2.331, 2.331, 2.486, 2.707, 2.708, 2.708, 2.708, 2.708)
fact = list(female_factors = female_factors, female_medicaid_factors = female_medicaid_factors, female_origdbld_factors = female_origdbld_factors, female_medicaid_origdbld_factors = female_medicaid_origdbld_factors, male_factors = male_factors, male_medicaid_factors = male_medicaid_factors, male_origdbld_factors = male_origdbld_factors, male_medicaid_origdbld_factors = male_medicaid_origdbld_factors)
names(fact$female_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_medicaid_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_origdbld_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$female_medicaid_origdbld_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_medicaid_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_origdbld_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
names(fact$male_medicaid_origdbld_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
factors <- list(female_factors = fact$female_factors, female_medicaid_factors = fact$female_medicaid_factors, female_origdbld_factors = fact$female_origdbld_factors, female_medicaid_origdbld_factors = fact$female_medicaid_origdbld_factors, male_factors = fact$male_factors, male_medicaid_factors = fact$male_medicaid_factors, male_origdbld_factors = fact$male_origdbld_factors, male_medicaid_origdbld_factors = fact$male_medicaid_origdbld_factors)
factors
save(factors, file = "factors_ne14.RData")
load("~/ValidateHealth/cmshcc/data/factors_ne14.RData")
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
factor_list$female_factors[1]
factor_list$female_factors[16]
factor_list$female_factors[PERSON$AGE_BAND]
test <- factor_list$female_factors[PERSON$AGE_BAND]
str(test)
test <- factor_list$female_factors[1:16]
str(test)
test <- factor_list$female_factors[c(1:16, 1:16)]
test
test <- PERSON$AGE_BAND
test
names(PERSON)
PERSON$AGE <- as.numeric(round(difftime(date, as.Date(PERSON$DOB, "%Y-%m-%d", tz = "UTC"), units = "weeks")/52.25))
PERSON$AGE <- as.numeric(round(difftime(Sys.Date(), as.Date(PERSON$DOB, "%Y-%m-%d", tz = "UTC"), units = "weeks")/52.25))
PERSON$ORIGDS <- (PERSON$AGE >= 65) & (PERSON$OREC %in% c(1,3))
breaks <- c(0, 35, 45, 55, 60, 65, 66, 67, 68, 69, 70, 75, 80, 85, 90, 95, 120)
PERSON$AGE_BAND <- cut(x = PERSON$AGE, breaks = breaks, include.lowest = TRUE, right = FALSE, labels = FALSE)
PERSON$FEMALE <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 0))
PERSON$FEMALE_MCAID <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 0))
PERSON$FEMALE_ORIGDS <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 1))
PERSON$FEMALE_MCAID_ORIGDS <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 1))
PERSON$MALE <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 0))
PERSON$MALE_MCAID <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 0))
PERSON$MALE_ORIGDS <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 1))
PERSON$MALE_MCAID_ORIGDS <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 1))
PERSON$TOTAL <- PERSON$FEMALE * factor_list$female_factors[PERSON$AGE_BAND] + PERSON$FEMALE_MCAID * factor_list$female__medicaid_factors[PERSON$AGE_BAND] + PERSON$FEMALE_ORIGDS * factor_list$female_origdbld_factors[PERSON$AGE_BAND] + PERSON$FEMALE_MCAID_ORIGDS * factor_list$female_medicaid_origdbld_factors[PERSON$AGE_BAND] + PERSON$MALE * factor_list$male_factors[PERSON$AGE_BAND] + PERSON$MALE_MCAID * factor_list$male__medicaid_factors[PERSON$AGE_BAND] + PERSON$MALE_ORIGDS * factor_list$male_origdbld_factors[PERSON$AGE_BAND] + PERSON$MALE_MCAID_ORIGDS * factor_list$male_medicaid_origdbld_fact[PERSON$AGE_BAND]
test <- PERSON$AGE_BAND
test
PERSON$FEMALE * factor_list$female_factors[PERSON$AGE_BAND]
PERSON$FEMALE_MCAID * factor_list$female__medicaid_factors[PERSON$AGE_BAND]
PERSON$FEMALE_ORIGDS * factor_list$female_origdbld_factors[PERSON$AGE_BAND]
labels(factor_list)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
PERSON$FEMALE * factor_list$female_factors[PERSON$AGE_BAND]
PERSON$FEMALE_MCAID * factor_list$female_medicaid_factors[PERSON$AGE_BAND]
PERSON$FEMALE_ORIGDS * factor_list$female_origdbld_factors[PERSON$AGE_BAND]
PERSON$FEMALE_MCAID_ORIGDS * factor_list$female_medicaid_origdbld_factors[PERSON$AGE_BAND]
factors
PERSON$MALE * factor_list$male_factors[PERSON$AGE_BAND]
PERSON$MALE_MCAID * factor_list$male__medicaid_factors[PERSON$AGE_BAND]
library(cmshcc)
PERSON$MALE_ORIGDS * factor_list$male_origdbld_factors[PERSON$AGE_BAND]
PERSON$MALE_MCAID_ORIGDS * factor_list$male_medicaid_origdbld_fact[PERSON$AGE_BAND]
icd9RiskAdjCMSHCCne13(PERSON = person)
load("~/ValidateHealth/cmshcc/data/factors_ne14.RData")
library(cmshcc)
library(cmshcc)
icd9RiskAdjCMSHCCne13(PERSON = person)
icd9RiskAdjCMSHCCne(PERSON = person)
library(cmshcc)
icd9RiskAdjCMSHCCne(PERSON = person)
library(cmshcc)
icd9RiskAdjCMSHCCne <- function(PERSON, date = Sys.Date(), factor_list = factors) {
PERSON$AGE <- as.numeric(round(difftime(date, as.Date(PERSON$DOB, "%Y-%m-%d", tz = "UTC"), units = "weeks")/52.25))
PERSON$ORIGDS <- (PERSON$AGE >= 65) & (PERSON$OREC %in% c(1,3))
breaks <- c(0, 35, 45, 55, 60, 65, 66, 67, 68, 69, 70, 75, 80, 85, 90, 95, 120)
PERSON$AGE_BAND <- cut(x = PERSON$AGE, breaks = breaks, include.lowest = TRUE, right = FALSE, labels = FALSE)
PERSON$FEMALE <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 0))
PERSON$FEMALE_MCAID <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 0))
PERSON$FEMALE_ORIGDS <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 1))
PERSON$FEMALE_MCAID_ORIGDS <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 2) & (PERSON$ORIGDS == 1))
PERSON$MALE <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 0))
PERSON$MALE_MCAID <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 0))
PERSON$MALE_ORIGDS <- as.numeric((PERSON$MCAID == 0) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 1))
PERSON$MALE_MCAID_ORIGDS <- as.numeric((PERSON$MCAID == 1) & (PERSON$SEX == 1) & (PERSON$ORIGDS == 1))
PERSON$TOTAL <- PERSON$FEMALE * factor_list$female_factors[PERSON$AGE_BAND] + PERSON$FEMALE_MCAID * factor_list$female_medicaid_factors[PERSON$AGE_BAND] + PERSON$FEMALE_ORIGDS * factor_list$female_origdbld_factors[PERSON$AGE_BAND] + PERSON$FEMALE_MCAID_ORIGDS * factor_list$female_medicaid_origdbld_factors[PERSON$AGE_BAND] + PERSON$MALE * factor_list$male_factors[PERSON$AGE_BAND] + PERSON$MALE_MCAID * factor_list$male_medicaid_factors[PERSON$AGE_BAND] + PERSON$MALE_ORIGDS * factor_list$male_origdbld_factors[PERSON$AGE_BAND] + PERSON$MALE_MCAID_ORIGDS * factor_list$male_medicaid_origdbld_fact[PERSON$AGE_BAND]
return(PERSON$TOTAL)
}
icd9RiskAdjCMSHCCne(PERSON = person)
factor_list <- factors
factor_list$female_medicaid_origdbld_factors[PERSON$AGE_BAND]
load("~/ValidateHealth/cmshcc/data/factors_ne13.RData")
fact <- factors
fact$female_origdbld_factors <- c(0, 0, 0, 0, 0, fact$female_origdbld_factors)
fact$female_origdbld_factors
names(fact$female_origdbld_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", names(fact$female_origdbld_factors))
names(fact$female_origdbld_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
fact$female_origdbld_factors
fact$female_origdbld_factors <- c(0, 0, 0, 0, 0, fact$female_origdbld_factors)
fact$male_origdbld_factors
fact$male_origdbld_factors <- c(0, 0, 0, 0, 0, fact$male_origdbld_factors)
names(fact$male_origdbld_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
fact$male_origdbld_factors
fact$male_medicaid_origdbld_factors <- c(0, 0, 0, 0, 0, fact$male_medicaid_origdbld_factors)
names(fact$male_medicaid_origdbld_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
fact$female_medicaid_origdbld_factors <- c(0, 0, 0, 0, 0, fact$female_medicaid_origdbld_factors)
names(fact$female_medicaid_origdbld_factors) <- c("0-34", "35-44", "45-54", "55-59", "60-64", "65", "66", "67", "68", "69", "70-74", "75-79", "80-84", "85-89", "90-94", "95+")
factors <- fact
save(factors, file = "factors_ne13.RData")
